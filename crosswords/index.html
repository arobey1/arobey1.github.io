<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/x-icon" href="../img/icons/soccerball.png">
    <title>Crosswords - Alex Robey</title>
    <link rel="stylesheet" href="../styles.css">
    <script src="../navbar/navbar-loader.js"></script>
    <style>
        /* Scope game font to wrapper so navbar retains site font */
        .crossword-wrapper {
            font-family: 'Palatino', 'Palatino Linotype', 'Book Antiqua', serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 0 0 20px 0; /* Reduced top padding to move closer to navbar */
            width: 100%;
            margin: 0 auto;
        }
        
        /* Hidden title/author */
        #puzzle-title, #puzzle-author {
            display: none;
        }

        .game-container {
            display: flex;
            gap: 10px; /* Reduced gap to bring clues closer */
            align-items: flex-start;
            justify-content: space-between;
            width: 100%;
            /* max-width removed to rely on parent container */
        }

        .puzzle-area {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .clue-banner {
            width: 100%;
            background-color: #a7d8ff; /* Same as highlighted clue */
            padding: 12px 20px;
            margin-bottom: 15px; /* Added gap between clue box and grid */
            text-align: left; /* Left align */
            font-size: 1.1rem;
            font-weight: 500;
            min-height: 3.5em;
            display: flex;
            align-items: center; /* Vertically centered per request */
            justify-content: flex-start; /* Left align flex content */
            /* Removed border-radius */
            /* Removed border */
            border: none;
            color: #000;
        }
        
        .toolbar {
            width: 100%;
            background-color: #f1f1f1; /* Light gray background for toolbar */
            border-bottom: 1px solid #ddd;
            display: flex;
            justify-content: center; /* Centered buttons */
            padding: 5px 20px;
            margin-bottom: 0; /* Flush with clue box */
            gap: 15px;
        }

        .toolbar-btn {
            background: none;
            border: none;
            cursor: pointer;
            font-family: inherit;
            font-size: 0.9rem;
            color: #333;
            padding: 5px 10px;
            border-radius: 4px;
            transition: background-color 0.2s;
        }
        
        .toolbar-btn:hover {
            background-color: #e0e0e0;
        }

        /* Dropdown styles */
        .dropdown {
            position: relative;
            display: inline-block;
        }

        .dropdown-content {
            display: none;
            position: absolute;
            background-color: #fff;
            min-width: 120px;
            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
            z-index: 1;
            border-radius: 4px;
            padding: 5px 0;
            left: 0;
            top: 100%;
        }

        .dropdown-content div {
            color: black;
            padding: 8px 16px;
            text-decoration: none;
            display: block;
            font-size: 0.9rem;
            cursor: pointer;
        }

        .dropdown-content div:hover {
            background-color: #f1f1f1;
        }

        .dropdown:hover .dropdown-content {
            display: block;
        }
        
        .dropdown:hover .toolbar-btn {
            background-color: #ddd;
        }

        .grid {
            display: grid;
            gap: 1px; /* Create 1px grid lines via background color */
            background-color: #000;
            /* Uniform 4px border */
            border: 4px solid #000;
            box-sizing: content-box;
            user-select: none;
            box-shadow: none;
        }

        .cell {
            background-color: #fff;
            position: relative;
            /* Let grid control size */
            width: 100%; 
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            font-weight: 500;
            text-transform: uppercase;
            cursor: pointer;
            /* Removed inset box-shadow to fix double-border look and too-thick lines */
        }

        .cell.black {
            background-color: #000;
            cursor: default;
        }

        .cell.active {
            background-color: #ffda00 !important; /* NYT Yellow */
        }
        
        .cell.highlight {
            background-color: #a7d8ff; /* NYT Blue */
        }
        
        .cell.wrong {
            color: red;
        }
        .cell.wrong .cell-content {
            color: red;
        }
        .cell.revealed .cell-content {
            color: #0d47a1; /* Dark blue for revealed text */
        }
        /* Pencil mark / triangle for revealed cells */
        .cell.revealed::after {
            content: '';
            position: absolute;
            top: 1px; /* Reduced offset */
            right: 1px; /* Reduced offset */
            width: 0; 
            height: 0; 
            border-left: 8px solid transparent; 
            border-top: 8px solid red; 
            border-bottom: none;
        }
        
        /* Blue marker for checked correct cells */
        .cell.checked-correct::after {
            content: '';
            position: absolute;
            top: 1px; /* Reduced offset */
            right: 1px; /* Reduced offset */
            width: 0; 
            height: 0; 
            border-left: 8px solid transparent;
            border-top: 8px solid #0d47a1;
            border-bottom: none;
        }
        
        .cell.checked-correct .cell-content {
             color: #000; /* Keep text black for checked cells, or maybe blue? User said "same color as revealed color" before. 
                           But now distinguishes markers. Let's assume text stays black for checked unless specified. 
                           Actually, "for those cells that are correct, they should turn the same color as the revealed color" was previous request.
                           If reveal marker is red, check marker is blue... maybe text color follows?
                           Revealed text is blue. 
                           Let's keep checked text black for now to distinguish, or blue?
                           Let's stick to marker color request: "marker is blue for check, and red for reveal". */
        }

        .cell-number {
            position: absolute;
            top: 1px;
            left: 2px;
            font-size: 10px;
            line-height: 1;
            font-weight: normal;
            pointer-events: none;
            color: #333;
        }
        
        .cell-content {
            padding-top: 8px; 
            pointer-events: none;
            color: #000; /* Ensure filled letters are black */
        }

        /* Rebus Overlay Styles */
        .rebus-overlay {
            position: absolute;
            background: white;
            border: 2px solid #0d47a1;
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
            z-index: 100;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 5px;
        }
        
        .rebus-input {
            border: none;
            outline: none;
            text-transform: uppercase;
            font-family: 'Palatino', 'Palatino Linotype', 'Book Antiqua', serif;
            font-weight: 500;
            text-align: center;
            width: 100px;
            font-size: 20px;
            background: transparent;
        }

        .clues-panel {
            display: flex;
            flex-direction: row; /* Side by side */
            gap: 10px;
            flex: 1; /* Take up remaining space */
            height: 600px; /* Fixed height to match grid + banner approx */
            border: none;
            background: transparent;
        }

        .clue-column {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
            border: none;
            background: transparent; /* Removed background color */
            /* border-radius removed (was 8px) */
        }

        .clue-column h3 {
            margin: 0;
            padding: 12px 15px 5px 15px; /* Adjusted padding for alignment and closer underline */
            /* Transparent header background */
            background: transparent;
            border-bottom: 2px solid #eee; /* Subtle separator */
            font-size: 0.9rem; /* Reduced from 1.0rem */
            font-weight: 900; /* Bolder */
            text-transform: uppercase;
            letter-spacing: 1px;
            color: #333; /* Darker text for better contrast/boldness */
            display: flex;
            align-items: center;
        }
        
        /* Remove the triangle arrow */
        .clue-column h3::before {
            display: none;
        }

        .clue-list {
            list-style: none;
            padding: 5px 0;
            margin: 0;
            overflow-y: auto;
            flex: 1;
            scrollbar-width: thin;
        }
        
        .clue-list::-webkit-scrollbar {
            width: 6px;
        }
        .clue-list::-webkit-scrollbar-thumb {
            background-color: #ccc;
            border-radius: 3px;
        }

        .clue-item {
            cursor: pointer;
            padding: 6px 15px;
            font-size: 0.85rem; /* Reduced from 0.9rem */
            border-bottom: none; /* Remove lines between clues */
            display: flex;
            line-height: 1.4;
            transition: background-color 0.1s;
            position: relative;
            margin-bottom: 2px;
            /* border-radius removed */
            margin: 0 5px; /* Spacing for hover effect */
        }
        
        .clue-item:hover {
            background-color: #f5f5f5;
        }

        /* Active Clue (the one we are typing in) */
        .clue-item.selected {
             background-color: #a7d8ff; 
             font-weight: 500;
        }
        
        /* Related Clue (the other direction for current cell) */
        .clue-item.related {
             background-color: #e1f5fe; /* Very light blue background */
        }
        
        /* Vertical bar indicator for related clue */
        .clue-item.related::after {
            content: '';
            position: absolute;
            left: 0; /* Moved to left */
            top: 0;
            bottom: 0;
            width: 8px; /* Increased from 6px to 8px */
            background-color: #ffda00; /* NYT Yellow */
            /* border-radius removed */
        }

        .clue-num {
            font-weight: 700;
            margin-right: 8px;
            min-width: 20px;
            text-align: right;
            color: #333;
        }
        
        .clue-text {
            flex: 1;
            color: #222;
        }

        /* Responsive adjustment */
        @media (max-width: 900px) {
            .game-container {
                flex-direction: column;
                align-items: center;
            }
            .clues-panel {
                width: 100%;
                max-width: 500px;
                height: 350px;
                flex-direction: row;
            }
            .clue-column {
                height: 100%;
            }
        }
        @media (max-width: 600px) {
            .clues-panel {
                flex-direction: column;
                height: auto;
                max-height: 500px;
            }
            .clue-column {
                height: 250px;
            }
             .cell {
                width: 28px;
                height: 28px;
                font-size: 16px;
            }
            .cell-number {
                font-size: 8px;
            }
        }

        /* Success Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }

        .modal-overlay.active {
            opacity: 1;
            pointer-events: auto;
        }

        .modal-content {
            background-color: white;
            padding: 40px;
            border-radius: 12px;
            text-align: center;
            max-width: 400px;
            width: 90%;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
            transform: translateY(20px);
            transition: transform 0.3s ease;
            border-top: 6px solid #ff8c00; /* Orange accent */
        }

        .modal-overlay.active .modal-content {
            transform: translateY(0);
        }

        .modal-title {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 10px;
            color: #333;
        }

        .modal-message {
            font-size: 1.1rem;
            margin-bottom: 30px;
            color: #555;
        }

        .modal-btn {
            background-color: #ff8c00; /* Orange button */
            color: white;
            border: none;
            padding: 12px 24px;
            font-size: 1rem;
            font-weight: bold;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.2s;
            font-family: inherit;
        }

        .modal-btn:hover {
            background-color: #e65100;
        }
    </style>
</head>
<body>
    <div class="container">
        <header></header>
        <main>
            <div class="crossword-wrapper">
                <div id="puzzle-title">Loading...</div>
                <div id="puzzle-author"></div>
                
                <div class="game-container">
                    <div class="puzzle-area">
                        <!-- Toolbar above the grid (or below banner, user said "sleek buttons") -->
                        <div class="toolbar">
                            <div class="dropdown">
                                <button class="toolbar-btn">Clear</button>
                                <div class="dropdown-content">
                                    <div id="btn-clear-word">Word</div>
                                    <div id="btn-clear-puzzle">Puzzle</div>
                                </div>
                            </div>
                            <div class="dropdown">
                                <button class="toolbar-btn">Reveal</button>
                                <div class="dropdown-content">
                                    <div id="btn-reveal-cell">Cell</div>
                                    <div id="btn-reveal-word">Word</div>
                                    <div id="btn-reveal-puzzle">Puzzle</div>
                                </div>
                            </div>
                            <div class="dropdown">
                                <button class="toolbar-btn">Check</button>
                                <div class="dropdown-content">
                                    <div id="btn-check-cell">Cell</div>
                                    <div id="btn-check-word">Word</div>
                                    <div id="btn-check-puzzle">Puzzle</div>
                                </div>
                            </div>
                            <button class="toolbar-btn" id="btn-rebus">Rebus</button>
                        </div>

                        <div class="clue-banner" id="clue-banner">
                            Click a square to start playing
                        </div>

                        <div id="grid-container" class="grid"></div>
                        
                        <!-- Rebus Input Overlay -->
                        <div id="rebus-overlay" class="rebus-overlay" style="display: none;">
                            <input type="text" id="rebus-input" class="rebus-input" autocomplete="off">
                        </div>
                    </div>
                    
                    <div class="clues-panel">
                        <div class="clue-column">
                            <h3>Across</h3>
                            <ul id="across-clues" class="clue-list"></ul>
                        </div>
                        <div class="clue-column">
                            <h3>Down</h3>
                            <ul id="down-clues" class="clue-list"></ul>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Success Modal -->
    <div id="success-modal" class="modal-overlay">
        <div class="modal-content">
            <!-- Fun Cartoon SVG -->
            <svg width="120" height="120" viewBox="0 0 100 100" class="success-cartoon">
                <!-- Bounce Animation -->
                <style>
                    .success-cartoon {
                        margin-bottom: 15px;
                        animation: bounce-cartoon 2s infinite ease-in-out;
                    }
                    @keyframes bounce-cartoon {
                        0%, 100% { transform: translateY(0) rotate(0deg); }
                        25% { transform: translateY(-10px) rotate(-5deg); }
                        75% { transform: translateY(-10px) rotate(5deg); }
                    }
                </style>
                <!-- Head -->
                <rect x="20" y="25" width="60" height="55" rx="12" ry="12" fill="#a7d8ff" stroke="#333" stroke-width="3" />
                <!-- Eyes -->
                <circle cx="38" cy="48" r="6" fill="#333" />
                <circle cx="62" cy="48" r="6" fill="#333" />
                <!-- Cheeks -->
                <circle cx="32" cy="58" r="4" fill="#ff8c00" opacity="0.5" />
                <circle cx="68" cy="58" r="4" fill="#ff8c00" opacity="0.5" />
                <!-- Smile -->
                <path d="M 38 65 Q 50 75 62 65" stroke="#333" stroke-width="3" fill="none" stroke-linecap="round" />
                <!-- Antenna -->
                <line x1="50" y1="25" x2="50" y2="10" stroke="#333" stroke-width="3" />
                <circle cx="50" cy="8" r="5" fill="#ffda00" stroke="#333" stroke-width="2" />
                <!-- Confetti bits -->
                <circle cx="15" cy="20" r="3" fill="#ff8c00" />
                <circle cx="85" cy="25" r="3" fill="#0d47a1" />
                <rect x="10" y="80" width="6" height="6" fill="#ffda00" transform="rotate(20 13 83)" />
                <rect x="85" y="70" width="6" height="6" fill="#ff8c00" transform="rotate(-15 88 73)" />
            </svg>
            <div class="modal-title">Congratulations!</div>
            <div class="modal-message">You solved the puzzle!</div>
            <button id="btn-view-solved" class="modal-btn">View Solved Puzzle</button>
        </div>
    </div>
        </main>
    </div>
    <script src="crossword.js"></script>
</body>
</html>
